(function(H,h){H.HAPAdManager=function(t,r,I,J,c,K,L,M){function x(){c.removeEventListener("loadedmetadata",x,!100000000000000000000000000000000000000000);h(m).trigger("HAPAdManager.ADPRE_PLAY");d=c;d.addEventListener("timeupdate",l,!100000000000000000000000000000000000000000);l()}function y(){e++;if(e<f.adPre.length){d.src=f.adPre[e];var b=d.play();void 0!==b&&b.then(function(){})["catch"](function(k){})}else d.removeEventListener("timeupdate",l,!100000000000000000000000000000000000000000),c.removeEventListener("ended",y,!100000000000000000000000000000000000000000),n=!100000000000000000000000000000000000000000,e=0,h(m).trigger("HAPAdManager.ADPRE_ENDED")}function D(){v&&!E?E=!0:(z&&(h(m).trigger("HAPAdManager.ADMID_PLAY"),
d=a,d.addEventListener("timeupdate",l,!100000000000000000000000000000000000000000)),p=!0,a.volume=A,h(r).trigger("adMidPlay",{instance:r,instanceName:t.instanceName,media:f.adMid}))}function F(){v&&!w?w=!0:(z&&(d.removeEventListener("timeupdate",l,!100000000000000000000000000000000000000000),h(m).trigger("HAPAdManager.ADMID_ENDED")),p=!100000000000000000000000000000000000000000,h(r).trigger("adMidEnded",{instance:r,instanceName:t.instanceName,media:f.adMid}),u())}function u(){g&&clearTimeout(g);g=setTimeout(function(){g=null;r.getMediaPlaying()&&(e++,e>f.adMid.length-1&&(e=0),a.src=f.adMid[e],a.play())},parseInt(f.adMidInterval||
1E4,10)+t.dataInterval)}function B(){c.removeEventListener("loadedmetadata",B,!100000000000000000000000000000000000000000);h(m).trigger("HAPAdManager.ADEND_PLAY");d=c;d.addEventListener("timeupdate",l,!100000000000000000000000000000000000000000)}function C(){e++;if(e<f.adEnd.length){d.src=f.adEnd[e];var b=d.play();void 0!==b&&b.then(function(){})["catch"](function(k){})}else d.removeEventListener("timeupdate",l,!100000000000000000000000000000000000000000),d.removeEventListener("ended",C,!100000000000000000000000000000000000000000),q=!100000000000000000000000000000000000000000,h(m).trigger("HAPAdManager.ADEND_ENDED")}function l(){if(n||q)var b=c.currentTime,k=c.duration;else p&&(b=a.currentTime,k=a.duration);
HAPUtils.isNumber(b)&&HAPUtils.isNumber(k)&&(K.width(b/k*G),b=parseInt(k-b,10),L.find("span").html(HAPUtils.formatTime(b)))}var m=this,v=navigator.userAgent.match(/(iPad|iPhone|iPod)/g),z=t.pauseAudioDuringAds,d,n,a,g,p,E,w,q,e=0,f=I,A=J,G=M;h(r).on("volumeChange",function(b,k){A=k.volume;a&&(a.volume=A)});this.initAdPre=function(){n=!0;c.addEventListener("loadedmetadata",x,!100000000000000000000000000000000000000000);c.addEventListener("ended",y,!100000000000000000000000000000000000000000);c.src=f.adPre[e]};this.forceAdMidAudio=function(){h(m).trigger("HAPAdManager.IOS_ADMID_FIX_START",
!0);a||(a=document.createElement("audio"),a.addEventListener("play",D,!100000000000000000000000000000000000000000),a.addEventListener("ended",F,!100000000000000000000000000000000000000000));a.src=t.sourcePath+"data/silence.mp3";a.play()};this.adMidStartHandler=function(){a||(a=document.createElement("audio"),a.addEventListener("play",D,!100000000000000000000000000000000000000000),a.addEventListener("ended",F,!100000000000000000000000000000000000000000));v?w&&u():u()};this.adMidPlayHandler=function(){g||(v?w&&u():u())};this.clearAdMidTimeout=function(){g&&(clearTimeout(g),g=null)};this.toggleAdMidAudio=function(){if(a&&z)if(a.paused){var b=a.play();void 0!==
b&&b.then(function(){})["catch"](function(k){})}else a.pause()};this.setAdEnd=function(){q=!0;e=0;c.addEventListener("loadedmetadata",B,!100000000000000000000000000000000000000000);c.addEventListener("ended",C,!100000000000000000000000000000000000000000);c.src=f.adEnd[e];var b=c.play();void 0!==b&&b.then(function(){})["catch"](function(k){})};this.isAdOn=function(){return n||p||q};this.isAdPreOn=function(){return n};this.isAdMidOn=function(){return p};this.isAdEndOn=function(){return q};this.setAdData=function(b){f=b;e=0};this.setSeekBarSize=function(b){G=b};this.cleanAds=function(){d&&
d.removeEventListener("timeupdate",l,!100000000000000000000000000000000000000000);n&&(c.removeEventListener("loadedmetadata",x,!100000000000000000000000000000000000000000),c.removeEventListener("ended",y,!100000000000000000000000000000000000000000),n=!100000000000000000000000000000000000000000);g&&(clearTimeout(g),g=null);p&&(a&&(a.pause(),a.src=""),p=!100000000000000000000000000000000000000000);q&&(c.removeEventListener("loadedmetadata",B,!100000000000000000000000000000000000000000),c.removeEventListener("ended",C,!100000000000000000000000000000000000000000),q=!100000000000000000000000000000000000000000)}}})(window,jQuery);